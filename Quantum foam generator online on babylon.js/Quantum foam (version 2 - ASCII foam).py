let createScene = function () {
    let scene = new BABYLON.Scene(engine);
    let camera = new BABYLON.ArcRotateCamera("Camera",
        BABYLON.Tools.ToRadians(90),
        BABYLON.Tools.ToRadians(60),
        60,
        new BABYLON.Vector3(0, 0, 0), scene);
    camera.attachControl(canvas, true);

    let light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);

    const shape = { x: 10, y: 10, z: 10 }; // Размер сетки 10x10x10
    const scale = 10.0;
    let points = [];
    const cube_size = 10;

    // Простая функция для генерации шума
    const simplexNoise = (x, y, z) => {
        return Math.sin(x / scale) * Math.cos(y / scale) * Math.sin(z / scale);
    };

    // Генерация 3D-массива шума
    const generateNoise = (base) => {
        let noise = [];
        for (let i = 0; i < shape.x; i++) {
            for (let j = 0; j < shape.y; j++) {
                for (let k = 0; k < shape.z; k++) {
                    let value = simplexNoise(i + base, j + base, k + base);
                    noise.push(value);
                }
            }
        }
        return noise;
    };

    // Ascii Texture
    const base64data = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAMgCAAAAAD+G1m0AAAAwnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjabVBbEsMgCPz3FD0CDzVwHNPYmd6gxy8K6cS2mxHWRTdI6q/nI90GCHPKZZOqtYIha1ZqRgQcbUaEPOMEAXCoi54+BTJpMN+BVM946nHhzNiMlYuR3KOwrwXN0YF8GZEnHh0NfoSRhhGTFzAMmj8Lqsp2fcLeYYX4SiNkWdv+2W82vaPYf5ioMzJYZBZvgMcqidskbQh2EO1rdkhdCTMbyL85nUhv4S5ZD5PlAu4AAAEiaUNDUElDQyBwcm9maWxlAAB4nJ2QsUrDUBSGv1RRKTpZHMQhg44FFzO5VIUgKMRYweiUJikWkxiSlOIb+Cb6MB0EwXdwVXD2v9HBwSxeOPwfh3P+/94LHTuNsmpxF7K8Ll1/EFwGV/byGx16dNnBDqOqGHjeCa3n8xXL6EvfeLXP/XmW4qSKpHNVHhVlDda+2JnVhWEVvduhfyh+ENtxlsfiJ/F2nMWGza6fpdPox9PcZjXJL85NX7WFyzGneNiMmDIhpaYvzdU5wmFP6lISck9FJE1J1JtppuZGVMnJ5UA0FOk2LXmbTZ6nlJE8JvIyCXdk8jR5mP/9Xvs4azatjXkRlmHTWlB1xmN4f4S1ANafoXvdkrXy+20tM04z8883fgH6s1Bu6NLQkAAADXhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDQuNC4wLUV4aXYyIj4KIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgIHhtbG5zOkdJTVA9Imh0dHA6Ly93d3cuZ2ltcC5vcmcveG1wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICB4bXBNTTpEb2N1bWVudElEPSJnaW1wOmRvY2lkOmdpbXA6ODA0NTIxZmItNDAwYi00OGZjLWI3MmEtM2JiZDU1ZjAxNWRkIgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZhZmEwYWRmLTAxNTktNDkwZC05YjkwLWQ5MjczZjdiYTRkZCIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmQ0MmFjZmY5LWM0ZGUtNDNhOC04NjZmLWFjYmI1ZjgyYzNhMyIKICAgZGM6Rm9ybWF0PSJpbWFnZS9wbmciCiAgIEdJTVA6QVBJPSIyLjAiCiAgIEdJTVA6UGxhdGZvcm09IkxpbnV4IgogICBHSU1QOlRpbWVTdGFtcD0iMTc0MDA0Nzk2MDUxNTQyNSIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjM4IgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNTowMjoyMFQxMTozOToyMCswMTowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjU6MDI6MjBUMTE6Mzk6MjArMDE6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoyYzM1ODhjMS1hZmRmLTQ3ZDgtODI4Ny1hZDllMzdjZWY5YmYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoTGludXgpIgogICAgICBzdEV2dDp3aGVuPSIyMDI1LTAyLTIwVDExOjM5OjIwKzAxOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PuyKD9AAAAACYktHRAAAqo0jMgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+kCFAonFJWskIwAACAASURBVHja7Z3bltwoDEXrePn/f1nzkEm6uso3QAJh7/0wk3S6KEA6SMLYfr0AAAAAAAAAAAAAAAAAAAAAAAAAAAAA4EbYTcYhTAlB8riFby0YE4AIAgPyqzs4FxEEAIEAIBAABAKAQAAQCAACAUAgAAgEAIEAAAKBx3P1tPHKVMEj5WHXjooRQeCp4cMQCMBBemUIBIagt/9SpANMWp/bVa0DeHuhJlDIhT4SQSAwy2IcANMmWUIgALsKwfcBzit1AAAAAAAAAAAAAAAAAAAAAAAAAACA0djD+ne1Pc7Ewyv//RHe/bveHgKB/C/d9O4fdxRCVbqhZ/SPhzYAOEEEAUvuDt79K2qPCAJKvlxq5HgRCAACgStLqpL3b8R4EQjkf9i0xo2XIh3+VK6pPcHc3fXqeBEIzCDfYd5KigXT6OMO2R3ABAkWEQSACAIEEAQCKGSgq5JiAbkOwD2yLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgHnhuyDU8bglf+96SPY7k8fQ9dSW2Sfjo0Zmn7N3D+dLEpPUgeyj923375vyc9u89c799ycfZIUYEa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";
    const asciiTexture = new BABYLON.Texture(base64data, scene, true, false, BABYLON.Texture.NEAREST_SAMPLINGMODE);

    BABYLON.Effect.ShadersStore["customFragmentShader"] = `
    #ifdef GL_ES
        precision highp float;
    #endif

    varying vec2 vUV;
    uniform sampler2D textureSampler;
    uniform vec2 screenSize;
    uniform float blockSize;
    uniform sampler2D asciiSampler;

    void main(void) 
    {
        // Pixelize + Black & White
        vec2 pixelSize = vec2(blockSize/screenSize.x, blockSize/screenSize.y);
        vec2 uv = floor(vUV / pixelSize) * pixelSize;
        vec4 baseColor = texture2D(textureSampler, uv);
        float BW = (baseColor.r+baseColor.g+baseColor.b)/3.0;

        // Delta pixels along this pixel block (to be mapped along a ASCII char)
        vec2 deltaPixel = vec2(screenSize.x*(vUV.x-uv.x), screenSize.y*(vUV.y-uv.y));

        // Matching UV for brighness
        float value = floor(100.0*pow(BW, 2.0));
        float X = mod(value, 10.0)/10.0;
        float Y = floor((value-X)/10.0)/10.0;
        float dX = 0.0+X;
        float dY = 0.1+Y;

        // Map UV in ASCII texture
        vec2 asciiUV = vec2(dX+(0.1*deltaPixel.x/blockSize), dY-(0.1*deltaPixel.y/blockSize));
        vec4 asciiColor = texture2D(asciiSampler, asciiUV);
        gl_FragColor = asciiColor;
    }
    `;

    var postProcess = new BABYLON.PostProcess("My custom post process", "custom", ["screenSize", "blockSize"], ["asciiSampler"], 1.0, camera);
    var blockSize = 16.0;
    postProcess.onApply = function (effect) {
        effect.setFloat2("screenSize", postProcess.width, postProcess.height);
        effect.setFloat("blockSize", blockSize);
        effect.setTexture("asciiSampler", asciiTexture);
    };

    // Основной рендеринг
    let base = 0;
    scene.registerAfterRender(() => {
        let noiseValues = generateNoise(base);
        base += 0.1; // Компонент для изменения базового значения

        // Удаляем предыдущие точки
        points.forEach(point => scene.removeMesh(point));
        points = [];

        // Генерация сфер в зависимости от значений шума
        for (let i = 0; i < noiseValues.length; i++) {
            const size = noiseValues[i]; // Используем значение шума для размера
            if (size > 0.5) { // Если значение выше порога 0.5, создаём "полноту"
                let diameter = size * 2; // Увеличиваем диаметр в зависимости от значения
                let point = BABYLON.MeshBuilder.CreateSphere(`point-${i}`, { diameter: diameter, segments: 8 }, scene);
                point.position.set(
                    (i % shape.x) * (cube_size / shape.x),
                    Math.floor((i / shape.x) % shape.y) * (cube_size / shape.y),
                    Math.floor(i / (shape.x * shape.y)) * (cube_size / shape.z)
                );
                points.push(point);
            }
        }
    });

    return scene;
};
export default createScene
